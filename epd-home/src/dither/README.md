Vendored from https://gitlab.com/efronlicht/dither which doesn't build as a library, and modified to remove unused bits.
